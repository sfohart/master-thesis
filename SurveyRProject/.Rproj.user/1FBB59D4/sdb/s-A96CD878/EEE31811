{
    "contents" : "#install.packages(\"dplyr\")\nload(\"surveyData.RData\")\n\nrequire(reshape2)\nrequire(ggplot2)\nrequire(scales)\nrequire(grid)\nrequire(dplyr)\n\nfator.tecnologico.labels <- c(\n  \"Facilidade de testar e de ser avaliado por usuários de um modo geral\",\n  \"Utilização de desenvolvimento e de qualidade bem definidos por parte do fabricante\",\n  \"Compatibilidade com a infraestrutura existente, com os requisitos / necessidades / demandas, e/ou com a tecnologia em vigor\",\n  \"Facilidade de entender, utilizar e/ou adaptar\",\n  \"Vantagem(ns) em relação a custos com hardware, requisitos mínimos menos exigentes, custos com licença ou suporte, etc\",\n  \"Maior eficiência em relação à solução, livre ou não, utilizada atualmente\",\n  \"Maior confiabilidade em relação à solução, livre ou não, utilizada atualmente\"  \n)\n\n# Quebrando o texto automaticamente (Só tirei os \\n do vetor de cima e acrescentei as 3 linhas abaixo)\ntamanho <- 35 # O limite de caracteres (ele vai quebrar no espaço anterior a palavra que ultrapassa o limite)\n(fator.tecnologico.labels <- strwrap(fator.tecnologico.labels, tamanho, simplify=F)) # Cria uma lista onde cada elemento é um vetor com até 40 caracteres. \n(fator.tecnologico.labels <- mapply(paste, fator.tecnologico.labels, collapse='\\n')) # Monta o vetor com as labels.\n\n\nfator.tecnologico.dados <- cbind(\n  table(as.numeric(data[,17])),\n  table(as.numeric(data[,18])),\n  table(as.numeric(data[,19])),\n  table(as.numeric(data[,20])),\n  table(as.numeric(data[,21])),\n  table(as.numeric(data[,22])),\n  table(as.numeric(data[,23]))\n)\n\nfator.tecnologico.resultado <- as.data.frame(\n  rbind(\n    colSums(fator.tecnologico.dados[3:4,]),\n    colSums(fator.tecnologico.dados[1:2,])\n  )\n)\n\n\nfator.tecnologico.resultado <- cbind(\n  fator.tecnologico.resultado,\n  Label = c(\"influência considerável ou alta\",\"pouca ou nenhuma influência\")\n  #Label = c(\"pouca ou nenhuma influência\",\"influência considerável ou alta\")\n)\n\n\n# Para usar o ggplot2 os dados precisam estar nesse formato.\nfator.tecnologico.resultado.agrupado <- reshape(\n  fator.tecnologico.resultado, \n  varying = list(c('V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7')), \n  direction='long', \n  idvar='Label', \n  times=fator.tecnologico.labels\n) \n\nfator.tecnologico.resultado.agrupado <- mutate(\n  group_by(\n    fator.tecnologico.resultado.agrupado, \n    time),\n  V1,\n  cumulativo = cumsum(V1) - (V1 * 0.5)\n  )\n\n#######################################################################################\n# gráfico novo, mostrando barras empilhadas, e agrupando os níveis de influência\n#######################################################################################\n\nmy_theme <- theme_update(panel.grid.major = element_line(colour = \"grey90\"), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.ticks = element_blank(), legend.position = \"top\") \n\nfator.tecnologico.resultado.agrupado.grafico <- ggplot(fator.tecnologico.resultado.agrupado, aes(x = time, y = V1, fill = Label)) + # Informa os dados\n  geom_bar(stat='identity', position=\"stack\", color = \"black\") + # Informa que tu quer um gráfico de barras\n  geom_text (aes(x = time, y = cumulativo, ymax = 152, label = sprintf(\"%d\\n(%.2f%%)\",V1, 100 * V1/152) ), size = 4, fontface = \"bold\", fontfamily= \"Arial\") +\n  theme(   text = element_text(size=17, colour = \"black\"), axis.text.y = element_text(colour = \"black\")) +\n  # Inverte os eixos X e Y\n  coord_flip() + \n  ylab('Frequência') + \n  xlab('Fatores de adoção') +  \n  ggtitle(\"Na sua opinião, em que grau estes fatores influenciam\\n a adoção de software livre do ponto de vista tecnológico?\") +\n  # Coloca titulo na legenda\n  #scale_fill_manual('Legenda', values = c(\"#66CC99\",\"#CC6666\"))\n  scale_fill_brewer(palette=\"Set2\")\n  #scale_fill_manual('Legenda', values = c(\"#00FF00\",\"#FF0000\"))\n\n\nfator.tecnologico.resultado.agrupado.grafico\n\nggsave(fator.tecnologico.resultado.agrupado.grafico, file=\"pictures/06-fator-tecnologico-stacked.png\")\n\n#######################################################################################\n# gráfico antigo, agora com percentuais\n#######################################################################################\n\nfator.tecnologico.dados.percentagem <- apply(\n  fator.tecnologico.dados,\n  2,\n  function(x) sprintf(\"%d (%.2f%%)\", x, x * 100 / 152)\n)\n\ncolnames(fator.tecnologico.dados) <- fator.tecnologico.labels\nrownames(fator.tecnologico.dados) <- c(\"nenhuma influência\",\"pouca influência\",\"influência considerável\",\"muita influência\")\n\n\npar(mar=c(5, 16, 4, 2))\n\nfator.tecnologico.dados.percentagem.graph <- barplot(\n  fator.tecnologico.dados,\n  beside = TRUE, \n  horiz=TRUE, \n  las=1,  \n  xlim=c(0,100),\n  cex.axis = 0.7,  \n  cex.names = 0.75,  \n  legend.text = rownames(fator.tecnologico.dados),\n  args.legend = list(\"bottom\", bty=\"n\", cex = 0.7),\n  col=rainbow(4),\n  xpd=FALSE,\n  cex.main = 0.9,\n  main=\"Na sua opinião,\\n em que grau destes fatores influenciam\\n a adoção de software livre em ambientes coorporativos?\"\n)\n\ntext(   \n  x = fator.tecnologico.dados, \n  y = fator.tecnologico.dados.percentagem.graph,\n  labels = fator.tecnologico.dados.percentagem,  \n  pos = 4,   \n  cex = .55)\n\ndev.copy(png,\"pictures/06-fator-tecnologico.png\",  width=1024, height=618, units = \"px\")\ndev.off()\n",
    "created" : 1428109314729.000,
    "dirty" : false,
    "encoding" : "ISO8859-1",
    "folds" : "",
    "hash" : "1418305176",
    "id" : "EEE31811",
    "lastKnownWriteTime" : 1428109495,
    "path" : "C:/Users/Leandro/git/master-thesis/SurveyRProject/tecnologicalAdoptionFactor.R",
    "project_path" : "tecnologicalAdoptionFactor.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}